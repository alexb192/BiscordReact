{"ast":null,"code":"var createHash = require('crypto').createHash;\n\nfunction get_header(header, credentials, opts) {\n  var type = header.split(' ')[0],\n      user = credentials[0],\n      pass = credentials[1];\n\n  if (type == 'Digest') {\n    return digest.generate(header, user, pass, opts.method, opts.path);\n  } else if (type == 'Basic') {\n    return basic(user, pass);\n  }\n} ////////////////////\n// basic\n\n\nfunction md5(string) {\n  return createHash('md5').update(string).digest('hex');\n}\n\nfunction basic(user, pass) {\n  var str = typeof pass == 'undefined' ? user : [user, pass].join(':');\n  return 'Basic ' + Buffer.from(str).toString('base64');\n} ////////////////////\n// digest\n// logic inspired from https://github.com/simme/node-http-digest-client\n\n\nvar digest = {};\n\ndigest.parse_header = function (header) {\n  var challenge = {},\n      matches = header.match(/([a-z0-9_-]+)=\"?([a-z0-9=\\/\\.@\\s-]+)\"?/gi);\n\n  for (var i = 0, l = matches.length; i < l; i++) {\n    var parts = matches[i].split('='),\n        key = parts.shift(),\n        val = parts.join('=').replace(/^\"/, '').replace(/\"$/, '');\n    challenge[key] = val;\n  }\n\n  return challenge;\n};\n\ndigest.update_nc = function (nc) {\n  var max = 99999999;\n  nc++;\n  if (nc > max) nc = 1;\n  var padding = new Array(8).join('0') + '';\n  nc = nc + '';\n  return padding.substr(0, 8 - nc.length) + nc;\n};\n\ndigest.generate = function (header, user, pass, method, path) {\n  var nc = 1,\n      cnonce = null,\n      challenge = digest.parse_header(header);\n  var ha1 = md5(user + ':' + challenge.realm + ':' + pass),\n      ha2 = md5(method.toUpperCase() + ':' + path),\n      resp = [ha1, challenge.nonce];\n\n  if (typeof challenge.qop === 'string') {\n    cnonce = md5(Math.random().toString(36)).substr(0, 8);\n    nc = digest.update_nc(nc);\n    resp = resp.concat(nc, cnonce);\n    resp = resp.concat(challenge.qop, ha2);\n  } else {\n    resp = resp.concat(ha2);\n  }\n\n  var params = {\n    uri: path,\n    realm: challenge.realm,\n    nonce: challenge.nonce,\n    username: user,\n    response: md5(resp.join(':'))\n  };\n\n  if (challenge.qop) {\n    params.qop = challenge.qop;\n  }\n\n  if (challenge.opaque) {\n    params.opaque = challenge.opaque;\n  }\n\n  if (cnonce) {\n    params.nc = nc;\n    params.cnonce = cnonce;\n  }\n\n  header = [];\n\n  for (var k in params) header.push(k + '=\"' + params[k] + '\"');\n\n  return 'Digest ' + header.join(', ');\n};\n\nmodule.exports = {\n  header: get_header,\n  basic: basic,\n  digest: digest.generate\n};","map":{"version":3,"sources":["/home/n/React/loginpagedemo/frontend/node_modules/needle/lib/auth.js"],"names":["createHash","require","get_header","header","credentials","opts","type","split","user","pass","digest","generate","method","path","basic","md5","string","update","str","join","Buffer","from","toString","parse_header","challenge","matches","match","i","l","length","parts","key","shift","val","replace","update_nc","nc","max","padding","Array","substr","cnonce","ha1","realm","ha2","toUpperCase","resp","nonce","qop","Math","random","concat","params","uri","username","response","opaque","k","push","module","exports"],"mappings":"AAAA,IAAIA,UAAU,GAAGC,OAAO,CAAC,QAAD,CAAP,CAAkBD,UAAnC;;AAEA,SAASE,UAAT,CAAoBC,MAApB,EAA4BC,WAA5B,EAAyCC,IAAzC,EAA+C;AAC7C,MAAIC,IAAI,GAAGH,MAAM,CAACI,KAAP,CAAa,GAAb,EAAkB,CAAlB,CAAX;AAAA,MACIC,IAAI,GAAGJ,WAAW,CAAC,CAAD,CADtB;AAAA,MAEIK,IAAI,GAAGL,WAAW,CAAC,CAAD,CAFtB;;AAIA,MAAIE,IAAI,IAAI,QAAZ,EAAsB;AACpB,WAAOI,MAAM,CAACC,QAAP,CAAgBR,MAAhB,EAAwBK,IAAxB,EAA8BC,IAA9B,EAAoCJ,IAAI,CAACO,MAAzC,EAAiDP,IAAI,CAACQ,IAAtD,CAAP;AACD,GAFD,MAEO,IAAIP,IAAI,IAAI,OAAZ,EAAqB;AAC1B,WAAOQ,KAAK,CAACN,IAAD,EAAOC,IAAP,CAAZ;AACD;AACF,C,CAED;AACA;;;AAEA,SAASM,GAAT,CAAaC,MAAb,EAAqB;AACnB,SAAOhB,UAAU,CAAC,KAAD,CAAV,CAAkBiB,MAAlB,CAAyBD,MAAzB,EAAiCN,MAAjC,CAAwC,KAAxC,CAAP;AACD;;AAED,SAASI,KAAT,CAAeN,IAAf,EAAqBC,IAArB,EAA2B;AACzB,MAAIS,GAAG,GAAI,OAAOT,IAAP,IAAe,WAAf,GAA6BD,IAA7B,GAAoC,CAACA,IAAD,EAAOC,IAAP,EAAaU,IAAb,CAAkB,GAAlB,CAA/C;AACA,SAAO,WAAWC,MAAM,CAACC,IAAP,CAAYH,GAAZ,EAAiBI,QAAjB,CAA0B,QAA1B,CAAlB;AACD,C,CAED;AACA;AACA;;;AAEA,IAAIZ,MAAM,GAAG,EAAb;;AAEAA,MAAM,CAACa,YAAP,GAAsB,UAASpB,MAAT,EAAiB;AACrC,MAAIqB,SAAS,GAAG,EAAhB;AAAA,MACIC,OAAO,GAAKtB,MAAM,CAACuB,KAAP,CAAa,0CAAb,CADhB;;AAGA,OAAK,IAAIC,CAAC,GAAG,CAAR,EAAWC,CAAC,GAAGH,OAAO,CAACI,MAA5B,EAAoCF,CAAC,GAAGC,CAAxC,EAA2CD,CAAC,EAA5C,EAAgD;AAC9C,QAAIG,KAAK,GAAGL,OAAO,CAACE,CAAD,CAAP,CAAWpB,KAAX,CAAiB,GAAjB,CAAZ;AAAA,QACIwB,GAAG,GAAKD,KAAK,CAACE,KAAN,EADZ;AAAA,QAEIC,GAAG,GAAKH,KAAK,CAACX,IAAN,CAAW,GAAX,EAAgBe,OAAhB,CAAwB,IAAxB,EAA8B,EAA9B,EAAkCA,OAAlC,CAA0C,IAA1C,EAAgD,EAAhD,CAFZ;AAIAV,IAAAA,SAAS,CAACO,GAAD,CAAT,GAAiBE,GAAjB;AACD;;AAED,SAAOT,SAAP;AACD,CAbD;;AAeAd,MAAM,CAACyB,SAAP,GAAmB,UAASC,EAAT,EAAa;AAC9B,MAAIC,GAAG,GAAG,QAAV;AACAD,EAAAA,EAAE;AAEF,MAAIA,EAAE,GAAGC,GAAT,EACED,EAAE,GAAG,CAAL;AAEF,MAAIE,OAAO,GAAG,IAAIC,KAAJ,CAAU,CAAV,EAAapB,IAAb,CAAkB,GAAlB,IAAyB,EAAvC;AACAiB,EAAAA,EAAE,GAAGA,EAAE,GAAG,EAAV;AACA,SAAOE,OAAO,CAACE,MAAR,CAAe,CAAf,EAAkB,IAAIJ,EAAE,CAACP,MAAzB,IAAmCO,EAA1C;AACD,CAVD;;AAYA1B,MAAM,CAACC,QAAP,GAAkB,UAASR,MAAT,EAAiBK,IAAjB,EAAuBC,IAAvB,EAA6BG,MAA7B,EAAqCC,IAArC,EAA2C;AAE3D,MAAIuB,EAAE,GAAU,CAAhB;AAAA,MACIK,MAAM,GAAM,IADhB;AAAA,MAEIjB,SAAS,GAAGd,MAAM,CAACa,YAAP,CAAoBpB,MAApB,CAFhB;AAIA,MAAIuC,GAAG,GAAI3B,GAAG,CAACP,IAAI,GAAG,GAAP,GAAagB,SAAS,CAACmB,KAAvB,GAA+B,GAA/B,GAAqClC,IAAtC,CAAd;AAAA,MACImC,GAAG,GAAI7B,GAAG,CAACH,MAAM,CAACiC,WAAP,KAAuB,GAAvB,GAA6BhC,IAA9B,CADd;AAAA,MAEIiC,IAAI,GAAG,CAACJ,GAAD,EAAMlB,SAAS,CAACuB,KAAhB,CAFX;;AAIA,MAAI,OAAOvB,SAAS,CAACwB,GAAjB,KAAyB,QAA7B,EAAuC;AACrCP,IAAAA,MAAM,GAAG1B,GAAG,CAACkC,IAAI,CAACC,MAAL,GAAc5B,QAAd,CAAuB,EAAvB,CAAD,CAAH,CAAgCkB,MAAhC,CAAuC,CAAvC,EAA0C,CAA1C,CAAT;AACAJ,IAAAA,EAAE,GAAO1B,MAAM,CAACyB,SAAP,CAAiBC,EAAjB,CAAT;AACAU,IAAAA,IAAI,GAAKA,IAAI,CAACK,MAAL,CAAYf,EAAZ,EAAgBK,MAAhB,CAAT;AACAK,IAAAA,IAAI,GAAKA,IAAI,CAACK,MAAL,CAAY3B,SAAS,CAACwB,GAAtB,EAA2BJ,GAA3B,CAAT;AACD,GALD,MAKO;AACLE,IAAAA,IAAI,GAAKA,IAAI,CAACK,MAAL,CAAYP,GAAZ,CAAT;AACD;;AAGD,MAAIQ,MAAM,GAAG;AACXC,IAAAA,GAAG,EAAQxC,IADA;AAEX8B,IAAAA,KAAK,EAAMnB,SAAS,CAACmB,KAFV;AAGXI,IAAAA,KAAK,EAAMvB,SAAS,CAACuB,KAHV;AAIXO,IAAAA,QAAQ,EAAG9C,IAJA;AAKX+C,IAAAA,QAAQ,EAAGxC,GAAG,CAAC+B,IAAI,CAAC3B,IAAL,CAAU,GAAV,CAAD;AALH,GAAb;;AAQA,MAAIK,SAAS,CAACwB,GAAd,EAAmB;AACjBI,IAAAA,MAAM,CAACJ,GAAP,GAAaxB,SAAS,CAACwB,GAAvB;AACD;;AAED,MAAIxB,SAAS,CAACgC,MAAd,EAAsB;AACpBJ,IAAAA,MAAM,CAACI,MAAP,GAAgBhC,SAAS,CAACgC,MAA1B;AACD;;AAED,MAAIf,MAAJ,EAAY;AACVW,IAAAA,MAAM,CAAChB,EAAP,GAAYA,EAAZ;AACAgB,IAAAA,MAAM,CAACX,MAAP,GAAgBA,MAAhB;AACD;;AAEDtC,EAAAA,MAAM,GAAG,EAAT;;AACA,OAAK,IAAIsD,CAAT,IAAcL,MAAd,EACEjD,MAAM,CAACuD,IAAP,CAAYD,CAAC,GAAG,IAAJ,GAAWL,MAAM,CAACK,CAAD,CAAjB,GAAuB,GAAnC;;AAEF,SAAO,YAAYtD,MAAM,CAACgB,IAAP,CAAY,IAAZ,CAAnB;AACD,CA9CD;;AAgDAwC,MAAM,CAACC,OAAP,GAAiB;AACfzD,EAAAA,MAAM,EAAGD,UADM;AAEfY,EAAAA,KAAK,EAAIA,KAFM;AAGfJ,EAAAA,MAAM,EAAGA,MAAM,CAACC;AAHD,CAAjB","sourcesContent":["var createHash = require('crypto').createHash;\n\nfunction get_header(header, credentials, opts) {\n  var type = header.split(' ')[0],\n      user = credentials[0],\n      pass = credentials[1];\n\n  if (type == 'Digest') {\n    return digest.generate(header, user, pass, opts.method, opts.path);\n  } else if (type == 'Basic') {\n    return basic(user, pass);\n  }\n}\n\n////////////////////\n// basic\n\nfunction md5(string) {\n  return createHash('md5').update(string).digest('hex');\n}\n\nfunction basic(user, pass) {\n  var str  = typeof pass == 'undefined' ? user : [user, pass].join(':');\n  return 'Basic ' + Buffer.from(str).toString('base64');\n}\n\n////////////////////\n// digest\n// logic inspired from https://github.com/simme/node-http-digest-client\n\nvar digest = {};\n\ndigest.parse_header = function(header) {\n  var challenge = {},\n      matches   = header.match(/([a-z0-9_-]+)=\"?([a-z0-9=\\/\\.@\\s-]+)\"?/gi);\n\n  for (var i = 0, l = matches.length; i < l; i++) {\n    var parts = matches[i].split('='),\n        key   = parts.shift(),\n        val   = parts.join('=').replace(/^\"/, '').replace(/\"$/, '');\n\n    challenge[key] = val;\n  }\n\n  return challenge;\n}\n\ndigest.update_nc = function(nc) {\n  var max = 99999999;\n  nc++;\n\n  if (nc > max)\n    nc = 1;\n\n  var padding = new Array(8).join('0') + '';\n  nc = nc + '';\n  return padding.substr(0, 8 - nc.length) + nc;\n}\n\ndigest.generate = function(header, user, pass, method, path) {\n\n  var nc        = 1,\n      cnonce    = null,\n      challenge = digest.parse_header(header);\n\n  var ha1  = md5(user + ':' + challenge.realm + ':' + pass),\n      ha2  = md5(method.toUpperCase() + ':' + path),\n      resp = [ha1, challenge.nonce];\n\n  if (typeof challenge.qop === 'string') {\n    cnonce = md5(Math.random().toString(36)).substr(0, 8);\n    nc     = digest.update_nc(nc);\n    resp   = resp.concat(nc, cnonce);\n    resp   = resp.concat(challenge.qop, ha2);\n  } else {\n    resp   = resp.concat(ha2);\n  }\n\n\n  var params = {\n    uri      : path,\n    realm    : challenge.realm,\n    nonce    : challenge.nonce,\n    username : user,\n    response : md5(resp.join(':'))\n  }\n\n  if (challenge.qop) {\n    params.qop = challenge.qop;\n  }\n\n  if (challenge.opaque) {\n    params.opaque = challenge.opaque;\n  }\n\n  if (cnonce) {\n    params.nc = nc;\n    params.cnonce = cnonce;\n  }\n\n  header = []\n  for (var k in params)\n    header.push(k + '=\"' + params[k] + '\"')\n\n  return 'Digest ' + header.join(', ');\n}\n\nmodule.exports = {\n  header : get_header,\n  basic  : basic,\n  digest : digest.generate\n}\n"]},"metadata":{},"sourceType":"script"}